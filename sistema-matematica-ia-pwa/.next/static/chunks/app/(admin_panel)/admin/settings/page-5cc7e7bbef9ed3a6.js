(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{876:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});var i=(0,t(6467).A)("outline","settings","IconSettings",[["path",{d:"M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z",key:"svg-0"}],["path",{d:"M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0",key:"svg-1"}]])},4230:(e,a,t)=>{"use strict";t.d(a,{p:()=>b});var i=t(5155);t(2115);var l=t(8750),s=t(8918),r=t(3131),o=t(3664),n=t(862),c=t(8104),d=t(6960),u=t(3347),h=t(6231),m=t(704),p={root:"m_6e45937b",loader:"m_e8eb006c",overlay:"m_df587f17"};let v={transitionProps:{transition:"fade",duration:0},overlayProps:{backgroundOpacity:.75},zIndex:(0,l.I)("overlay")},g=(0,s.V)((e,a)=>{let{zIndex:t}=a;return{root:{"--lo-z-index":null==t?void 0:t.toString()}}}),b=(0,d.P9)((e,a)=>{let t=(0,o.Y)("LoadingOverlay",v,e),{classNames:l,className:s,style:d,styles:b,unstyled:x,vars:y,transitionProps:w,loaderProps:C,overlayProps:j,visible:f,zIndex:k,...A}=t,z=(0,r.xd)(),P=(0,n.I)({name:"LoadingOverlay",classes:p,props:t,className:s,style:d,classNames:l,styles:b,unstyled:x,vars:y,varsResolver:g}),E={...v.overlayProps,...j};return(0,i.jsx)(m.e,{transition:"fade",...w,mounted:!!f,children:e=>(0,i.jsxs)(c.a,{...P("root",{style:e}),ref:a,...A,children:[(0,i.jsx)(u.a,{...P("loader"),unstyled:x,...C}),(0,i.jsx)(h.h,{...E,...P("overlay"),darkHidden:!0,unstyled:x,color:(null==j?void 0:j.color)||z.white}),(0,i.jsx)(h.h,{...E,...P("overlay"),lightHidden:!0,unstyled:x,color:(null==j?void 0:j.color)||z.colors.dark[5]})]})})});b.classes=p,b.displayName="@mantine/core/LoadingOverlay"},4568:(e,a,t)=>{Promise.resolve().then(t.bind(t,8505))},6231:(e,a,t)=>{"use strict";t.d(a,{h:()=>g});var i=t(5155),l=t(5903);t(2115);var s=t(8750),r=t(6204),o=t(8918),n=t(714),c=t(3664),d=t(862),u=t(8104),h=t(4511),m={root:"m_9814e45f"};let p={zIndex:(0,s.I)("modal")},v=(0,o.V)((e,a)=>{let{gradient:t,color:i,backgroundOpacity:s,blur:o,radius:c,zIndex:d}=a;return{root:{"--overlay-bg":t||(void 0!==i||void 0!==s)&&(0,n.B)(i||"#000",null!=s?s:.6)||void 0,"--overlay-filter":o?"blur(".concat((0,l.D)(o),")"):void 0,"--overlay-radius":void 0===c?void 0:(0,r.nJ)(c),"--overlay-z-index":null==d?void 0:d.toString()}}}),g=(0,h.v)((e,a)=>{let t=(0,c.Y)("Overlay",p,e),{classNames:l,className:s,style:r,styles:o,unstyled:n,vars:h,fixed:g,center:b,children:x,radius:y,zIndex:w,gradient:C,blur:j,color:f,backgroundOpacity:k,mod:A,...z}=t,P=(0,d.I)({name:"Overlay",props:t,classes:m,className:s,style:r,classNames:l,styles:o,unstyled:n,vars:h,varsResolver:v});return(0,i.jsx)(u.a,{ref:a,...P("root"),mod:[{center:b,fixed:g},A],...z,children:x})});g.classes=m,g.displayName="@mantine/core/Overlay"},8505:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>U});var i=t(5155),l=t(2115),s=t(8104),r=t(4230),o=t(8887),n=t(4634),c=t(3751),d=t(7287),u=t(737),h=t(4173),m=t(7613),p=t(6204),v=t(8918),g=t(1180),b=t(3664),x=t(862),y=t(9537),w=t(6960),C=t(4598);let j=(0,l.createContext)(null),f=j.Provider,k=()=>(0,l.useContext)(j);var A=t(2871),z=t(537);let P={},E=(0,w.P9)((e,a)=>{let{value:t,defaultValue:l,onChange:s,size:r,wrapperProps:o,children:n,readOnly:c,...d}=(0,b.Y)("SwitchGroup",P,e),[u,h]=(0,m.Z)({value:t,defaultValue:l,finalValue:[],onChange:s});return(0,i.jsx)(f,{value:{value:u,onChange:e=>{let a=e.currentTarget.value;c||h(u.includes(a)?u.filter(e=>e!==a):[...u,a])},size:r},children:(0,i.jsx)(A.p.Wrapper,{size:r,ref:a,...o,...d,labelElement:"div",__staticSelector:"SwitchGroup",children:(0,i.jsx)(z.F,{role:"group",children:n})})})});E.classes=A.p.Wrapper.classes,E.displayName="@mantine/core/SwitchGroup";var I={root:"m_5f93f3bb",input:"m_926b4011",track:"m_9307d992",thumb:"m_93039a1d",trackLabel:"m_8277e082"};let S={labelPosition:"right",withThumbIndicator:!0},_=(0,v.V)((e,a)=>{let{radius:t,color:i,size:l}=a;return{root:{"--switch-radius":void 0===t?void 0:(0,p.nJ)(t),"--switch-height":(0,p.YC)(l,"switch-height"),"--switch-width":(0,p.YC)(l,"switch-width"),"--switch-thumb-size":(0,p.YC)(l,"switch-thumb-size"),"--switch-label-font-size":(0,p.YC)(l,"switch-label-font-size"),"--switch-track-label-padding":(0,p.YC)(l,"switch-track-label-padding"),"--switch-color":i?(0,g.r)(i,e):void 0}}}),D=(0,w.P9)((e,a)=>{var t;let l=(0,b.Y)("Switch",S,e),{classNames:r,className:o,style:n,styles:c,unstyled:d,vars:u,color:p,label:v,offLabel:g,onLabel:w,id:j,size:f,radius:A,wrapperProps:z,thumbIcon:P,checked:E,defaultChecked:D,onChange:B,labelPosition:N,description:O,error:Y,disabled:M,variant:V,rootRef:G,mod:L,withThumbIndicator:T,...F}=l,$=k(),q=f||(null==$?void 0:$.size),H=(0,x.I)({name:"Switch",props:l,classes:I,className:o,style:n,classNames:r,styles:c,unstyled:d,vars:u,varsResolver:_}),{styleProps:R,rest:J}=(0,y.j)(F),Q=(0,h.B)(j),W=$?{checked:$.value.includes(J.value),onChange:$.onChange}:{},[Z,K]=(0,m.Z)({value:null!=(t=W.checked)?t:E,defaultValue:D,finalValue:!1});return(0,i.jsxs)(C.I,{...H("root"),__staticSelector:"Switch",__stylesApiProps:l,id:Q,size:q,labelPosition:N,label:v,description:O,error:Y,disabled:M,bodyElement:"label",labelElement:"span",classNames:r,styles:c,unstyled:d,"data-checked":W.checked||E||void 0,variant:V,ref:G,mod:L,...R,...z,children:[(0,i.jsx)("input",{...J,disabled:M,checked:Z,"data-checked":W.checked||E||void 0,onChange:e=>{var a;$?null==(a=W.onChange)||a.call(W,e):null==B||B(e),K(e.currentTarget.checked)},id:Q,ref:a,type:"checkbox",role:"switch",...H("input")}),(0,i.jsxs)(s.a,{"aria-hidden":"true",component:"span",mod:{error:Y,"label-position":N,"without-labels":!w&&!g},...H("track"),children:[(0,i.jsx)(s.a,{component:"span",mod:{"reduce-motion":!0,"with-thumb-indicator":T&&!P},...H("thumb"),children:P}),(0,i.jsx)("span",{...H("trackLabel"),children:Z?w:g})]})]})});D.classes={...I,...C.M},D.displayName="@mantine/core/Switch",D.Group=E;var B=t(7683),N=t(112),O=t(6707),Y=t(9511),M=t(8977),V=t(876),G=t(6467),L=(0,G.A)("outline","check","IconCheck",[["path",{d:"M5 12l5 5l10 -10",key:"svg-0"}]]),T=(0,G.A)("outline","rosette-discount-check","IconRosetteDiscountCheck",[["path",{d:"M5 7.2a2.2 2.2 0 0 1 2.2 -2.2h1a2.2 2.2 0 0 0 1.55 -.64l.7 -.7a2.2 2.2 0 0 1 3.12 0l.7 .7c.412 .41 .97 .64 1.55 .64h1a2.2 2.2 0 0 1 2.2 2.2v1c0 .58 .23 1.138 .64 1.55l.7 .7a2.2 2.2 0 0 1 0 3.12l-.7 .7a2.2 2.2 0 0 0 -.64 1.55v1a2.2 2.2 0 0 1 -2.2 2.2h-1a2.2 2.2 0 0 0 -1.55 .64l-.7 .7a2.2 2.2 0 0 1 -3.12 0l-.7 -.7a2.2 2.2 0 0 0 -1.55 -.64h-1a2.2 2.2 0 0 1 -2.2 -2.2v-1a2.2 2.2 0 0 0 -.64 -1.55l-.7 -.7a2.2 2.2 0 0 1 0 -3.12l.7 -.7a2.2 2.2 0 0 0 .64 -1.55v-1",key:"svg-0"}],["path",{d:"M9 12l2 2l4 -4",key:"svg-1"}]]),F=t(1659),$=t(9161),q=t(1153),H=t(6715),R=t(2960),J=t(5041),Q=t(6942),W=t(2956);let Z={getSettings:async()=>(await W.u.get("/configuration")).data,updateSettings:async e=>(await W.u.patch("/configuration",e)).data},K=q.z.object({openAiPromptBase:q.z.string().nullable().optional(),welcomeCreditEnabled:q.z.boolean(),welcomeCreditAmount:q.z.number().min(0,"Debe ser 0 o m\xe1s").int("Debe ser un n\xfamero entero")});function U(){let e=(0,H.jE)(),{data:a,isLoading:t,isError:h,error:m,refetch:p}=(0,R.I)({queryKey:["system-settings"],queryFn:Z.getSettings,staleTime:3e5}),v=(0,F.m)({initialValues:{openAiPromptBase:"",welcomeCreditEnabled:!0,welcomeCreditAmount:1},validate:(0,$.u)(K)});(0,l.useEffect)(()=>{a&&(v.setValues({openAiPromptBase:a.openAiPromptBase||"",welcomeCreditEnabled:a.welcomeCreditEnabled,welcomeCreditAmount:a.welcomeCreditAmount}),v.resetDirty(a))},[a]);let{mutateAsync:g}=(0,J.n)({mutationFn:Z.updateSettings,onSuccess:a=>{console.log("updatedSettings",a),Q.$e.show({title:"Configuraci\xf3n Guardada",message:"La configuraci\xf3n del sistema ha sido actualizada exitosamente.",color:"green",icon:(0,i.jsx)(Y.A,{size:18})}),e.setQueryData(["system-settings"],a),v.resetDirty(a)},onError:e=>{Q.$e.show({title:"Error al Guardar",message:e.message||"No se pudo guardar la configuraci\xf3n.",color:"red",icon:(0,i.jsx)(M.A,{size:18})})}}),b=async e=>{await g(e)};return t?(0,i.jsx)(s.a,{p:"lg",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"calc(100vh - 200px)"},children:(0,i.jsx)(r.p,{visible:!0,overlayProps:{blur:2},loaderProps:{children:(0,i.jsx)(o.E,{children:"Cargando configuraci\xf3n..."})}})}):h?(0,i.jsx)(s.a,{p:"lg",children:(0,i.jsxs)(n.F,{icon:(0,i.jsx)(M.A,{size:"1rem"}),title:"Error de Carga",color:"red",children:["No se pudo cargar la configuraci\xf3n del sistema.",(null==m?void 0:m.message)&&(0,i.jsxs)(o.E,{size:"xs",mt:"xs",children:["Detalle: ",m.message]})]})}):(0,i.jsxs)(s.a,{p:"lg",className:"settings-page-container",children:[(0,i.jsxs)(c.h,{order:2,mb:"xl",className:"page-main-title",children:[(0,i.jsx)(V.A,{size:28,style:{marginRight:"10px",verticalAlign:"bottom"}}),"Configuraci\xf3n del Sistema"]}),(0,i.jsx)(d.t,{withBorder:!0,shadow:"md",p:"xl",radius:"md",children:(0,i.jsxs)("form",{onSubmit:v.onSubmit(b),children:[(0,i.jsx)(u.T,{label:"Prompt Base para OpenAI (GPT)",placeholder:"Define el comportamiento base para la IA al resolver problemas...",...v.getInputProps("openAiPromptBase"),minRows:4,autosize:!0,mb:"lg",description:"Este prompt se usar\xe1 como base para las solicitudes a la IA de resoluci\xf3n."}),(0,i.jsx)(D,{label:"Habilitar Cr\xe9dito de Bienvenida",...v.getInputProps("welcomeCreditEnabled",{type:"checkbox"}),color:"teal",size:"md",thumbIcon:v.values.welcomeCreditEnabled?(0,i.jsx)(L,{style:{width:"12px",height:"12px"}}):(0,i.jsx)(T,{style:{width:"12px",height:"12px"}}),mb:"xs"}),(0,i.jsx)(B.Q,{label:"Cantidad de Cr\xe9ditos de Bienvenida",placeholder:"N\xfamero de cr\xe9ditos",required:!0,min:0,step:1,...v.getInputProps("welcomeCreditAmount"),disabled:!v.values.welcomeCreditEnabled,mb:"xl"}),(0,i.jsxs)(N.Y,{justify:"flex-end",mt:"xl",children:[(0,i.jsx)(O.$,{variant:"default",onClick:()=>{a&&(v.setValues({openAiPromptBase:a.openAiPromptBase||"",welcomeCreditEnabled:a.welcomeCreditEnabled,welcomeCreditAmount:a.welcomeCreditAmount}),v.resetDirty(a)),Q.$e.show({title:"Cambios Descartados",message:"",color:"blue",autoClose:2e3})},disabled:!v.isDirty(),children:"Descartar"}),(0,i.jsx)(O.$,{type:"submit",loading:!1,disabled:!v.isDirty(),leftSection:(0,i.jsx)(Y.A,{size:18}),children:"Guardar Configuraci\xf3n"})]})]})})]})}},9511:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});var i=(0,t(6467).A)("outline","device-floppy","IconDeviceFloppy",[["path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M14 4l0 4l-6 0l0 -4",key:"svg-2"}]])}},e=>{var a=a=>e(e.s=a);e.O(0,[438,660,877,700,219,142,347,749,90,622,441,684,358],()=>a(4568)),_N_E=e.O()}]);