(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[651],{1343:(e,a,t)=>{Promise.resolve().then(t.bind(t,6385))},2990:(e,a,t)=>{"use strict";t.d(a,{H:()=>y});var i=t(5155),r=t(7287),s=t(8593),o=t(737),n=t(112),l=t(7683),d=t(9260),c=t(6707),u=t(1659),p=t(9161),m=t(1153),g=t(2115),v=t(9840),h=t.n(v);let x=m.z.object({name:m.z.string().min(3,{message:"Nombre debe tener al menos 3 caracteres"}),description:m.z.string().nullable().optional(),creditAmount:m.z.number().min(1,{message:"Cantidad de cr\xe9ditos debe ser al menos 1"}).int(),isActive:m.z.boolean()});function y(e){let{initialData:a,onSubmit:t,isSaving:m,onCancel:v}=e,y=(0,u.m)({initialValues:a?{name:a.name,description:a.description||null,creditAmount:a.creditAmount,price:a.price,isActive:a.isActive}:{name:"",description:null,creditAmount:1,price:0,isActive:!0},validate:(0,p.u)(x)});return(0,g.useEffect)(()=>{a&&y.setValues({name:a.name,description:a.description||null,creditAmount:a.creditAmount,price:a.price,isActive:a.isActive})},[a]),(0,i.jsx)(r.t,{withBorder:!0,shadow:"sm",p:"lg",radius:"md",className:h().formPaper,children:(0,i.jsxs)("form",{onSubmit:y.onSubmit(e=>t(e)),children:[(0,i.jsx)(s.k,{label:"Nombre del Paquete",placeholder:"Ej: Paquete B\xe1sico 10",required:!0,...y.getInputProps("name"),mb:"md"}),(0,i.jsx)(o.T,{label:"Descripci\xf3n (Opcional)",placeholder:"Detalles sobre el paquete...",...y.getInputProps("description"),minRows:2,autosize:!0,mb:"md"}),(0,i.jsxs)(n.Y,{grow:!0,mb:"md",children:[(0,i.jsx)(l.Q,{label:"Cantidad de Cr\xe9ditos",placeholder:"Ej: 10",required:!0,min:1,step:1,...y.getInputProps("creditAmount")}),(0,i.jsx)(l.Q,{label:"Precio (PEN)",placeholder:"Ej: 50.00",required:!0,min:.01,step:.01,...y.getInputProps("price"),leftSection:"S/"})]}),(0,i.jsx)(d.S,{label:"Paquete Activo",...y.getInputProps("isActive",{type:"checkbox"}),mt:"md",mb:"xl"}),(0,i.jsxs)(n.Y,{justify:"flex-end",mt:"lg",children:[(0,i.jsx)(c.$,{variant:"default",onClick:v,disabled:m,children:"Cancelar"}),(0,i.jsx)(c.$,{type:"submit",loading:m,disabled:!y.isDirty()&&!m,children:a?"Actualizar Paquete":"Crear Paquete"})]})]})})}},4230:(e,a,t)=>{"use strict";t.d(a,{p:()=>x});var i=t(5155);t(2115);var r=t(8750),s=t(8918),o=t(3131),n=t(3664),l=t(862),d=t(8104),c=t(6960),u=t(3347),p=t(6231),m=t(704),g={root:"m_6e45937b",loader:"m_e8eb006c",overlay:"m_df587f17"};let v={transitionProps:{transition:"fade",duration:0},overlayProps:{backgroundOpacity:.75},zIndex:(0,r.I)("overlay")},h=(0,s.V)((e,a)=>{let{zIndex:t}=a;return{root:{"--lo-z-index":null==t?void 0:t.toString()}}}),x=(0,c.P9)((e,a)=>{let t=(0,n.Y)("LoadingOverlay",v,e),{classNames:r,className:s,style:c,styles:x,unstyled:y,vars:j,transitionProps:b,loaderProps:k,overlayProps:P,visible:A,zIndex:f,...C}=t,z=(0,o.xd)(),q=(0,l.I)({name:"LoadingOverlay",classes:g,props:t,className:s,style:c,classNames:r,styles:x,unstyled:y,vars:j,varsResolver:h}),w={...v.overlayProps,...P};return(0,i.jsx)(m.e,{transition:"fade",...b,mounted:!!A,children:e=>(0,i.jsxs)(d.a,{...q("root",{style:e}),ref:a,...C,children:[(0,i.jsx)(u.a,{...q("loader"),unstyled:y,...k}),(0,i.jsx)(p.h,{...w,...q("overlay"),darkHidden:!0,unstyled:y,color:(null==P?void 0:P.color)||z.white}),(0,i.jsx)(p.h,{...w,...q("overlay"),lightHidden:!0,unstyled:y,color:(null==P?void 0:P.color)||z.colors.dark[5]})]})})});x.classes=g,x.displayName="@mantine/core/LoadingOverlay"},6231:(e,a,t)=>{"use strict";t.d(a,{h:()=>h});var i=t(5155),r=t(5903);t(2115);var s=t(8750),o=t(6204),n=t(8918),l=t(714),d=t(3664),c=t(862),u=t(8104),p=t(4511),m={root:"m_9814e45f"};let g={zIndex:(0,s.I)("modal")},v=(0,n.V)((e,a)=>{let{gradient:t,color:i,backgroundOpacity:s,blur:n,radius:d,zIndex:c}=a;return{root:{"--overlay-bg":t||(void 0!==i||void 0!==s)&&(0,l.B)(i||"#000",null!=s?s:.6)||void 0,"--overlay-filter":n?"blur(".concat((0,r.D)(n),")"):void 0,"--overlay-radius":void 0===d?void 0:(0,o.nJ)(d),"--overlay-z-index":null==c?void 0:c.toString()}}}),h=(0,p.v)((e,a)=>{let t=(0,d.Y)("Overlay",g,e),{classNames:r,className:s,style:o,styles:n,unstyled:l,vars:p,fixed:h,center:x,children:y,radius:j,zIndex:b,gradient:k,blur:P,color:A,backgroundOpacity:f,mod:C,...z}=t,q=(0,c.I)({name:"Overlay",props:t,classes:m,className:s,style:o,classNames:r,styles:n,unstyled:l,vars:p,varsResolver:v});return(0,i.jsx)(u.a,{ref:a,...q("root"),mod:[{center:x,fixed:h},C],...z,children:y})});h.classes=m,h.displayName="@mantine/core/Overlay"},6385:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>k});var i=t(5155),r=t(5695),s=t(8104),o=t(4230),n=t(8887),l=t(4634),d=t(112),c=t(3751),u=t(6707),p=t(9511),m=t(8977),g=t(5647),v=t(6715),h=t(2960),x=t(5041),y=t(6942),j=t(7651),b=t(2990);function k(){let e=(0,r.useRouter)(),a=(0,r.useParams)().id,t=(0,v.jE)(),{data:k,isLoading:P,isError:A,error:f,refetch:C}=(0,h.I)({queryKey:["credit-package",a],queryFn:()=>j.d.getCreditPackageById(a),enabled:!!a,staleTime:3e5}),{mutateAsync:z}=(0,x.n)({mutationFn:e=>j.d.updateCreditPackage(a,e),onSuccess:r=>{y.$e.show({title:"Paquete Actualizado",message:'El paquete "'.concat(r.name,'" ha sido actualizado exitosamente.'),color:"green",icon:(0,i.jsx)(p.A,{size:18})}),t.invalidateQueries({queryKey:["credit-packages"]}),t.setQueryData(["credit-package",a],r),e.push("/admin/credit-packages")},onError:e=>{y.$e.show({title:"Error al Actualizar",message:e.message||"No se pudo actualizar el paquete de cr\xe9dito.",color:"red",icon:(0,i.jsx)(m.A,{size:18})})}}),q=async e=>{let a={name:e.name,description:e.description,creditAmount:e.creditAmount,price:e.price,isActive:e.isActive};await z(a)};if(P)return(0,i.jsx)(s.a,{p:"lg",style:{display:"flex",justifyContent:"center",alignItems:"center",height:"calc(100vh - 200px)"},children:(0,i.jsx)(o.p,{visible:!0,overlayProps:{blur:2},loaderProps:{children:(0,i.jsx)(n.E,{children:"Cargando datos del paquete..."})}})});if(A||!k)return(0,i.jsx)(s.a,{p:"lg",children:(0,i.jsxs)(l.F,{icon:(0,i.jsx)(m.A,{size:"1rem"}),title:"Error de Carga",color:"red",withCloseButton:!0,onClose:()=>e.push("/admin/credit-packages"),children:["No se pudieron cargar los datos del paquete o el paquete no existe.",(null==f?void 0:f.message)&&(0,i.jsxs)(n.E,{size:"xs",mt:"xs",children:["Detalle: ",f.message]})]})});let w={name:k.name,description:k.description||null,creditAmount:k.credit_amount||0,price:k.price,isActive:k.is_active};return console.log("initialFormDataForForm",w,k),(0,i.jsxs)(s.a,{p:"lg",className:"form-page-container",children:[(0,i.jsxs)(d.Y,{justify:"space-between",mb:"xl",children:[(0,i.jsx)(c.h,{order:3,children:"Editar Paquete de Cr\xe9dito"}),(0,i.jsx)(u.$,{onClick:()=>e.push("/admin/credit-packages"),variant:"default",size:"xs",leftSection:(0,i.jsx)(g.A,{size:16}),children:"Volver a la Lista"})]}),(0,i.jsx)(b.H,{initialData:w,onSubmit:q,isSaving:!1,onCancel:()=>e.push("/admin/credit-packages")})]})}},7651:(e,a,t)=>{"use strict";t.d(a,{d:()=>r});var i=t(2956);let r={getCreditPackages:async()=>(await i.u.get("/credit-packages")).data,getCreditPackageById:async e=>(await i.u.get("/credit-packages/".concat(e))).data,createCreditPackage:async e=>(await i.u.post("/credit-packages",e)).data,updateCreditPackage:async(e,a)=>(await i.u.patch("/credit-packages/".concat(e),a)).data,async deleteCreditPackage(e){await i.u.delete("/credit-packages/".concat(e))}}},9511:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});var i=(0,t(6467).A)("outline","device-floppy","IconDeviceFloppy",[["path",{d:"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2",key:"svg-0"}],["path",{d:"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0",key:"svg-1"}],["path",{d:"M14 4l0 4l-6 0l0 -4",key:"svg-2"}]])},9840:e=>{e.exports={formPaper:"CreditPackageFormComponent_formPaper__GaREb"}}},e=>{var a=a=>e(e.s=a);e.O(0,[967,438,660,877,700,219,142,347,749,90,936,622,441,684,358],()=>a(1343)),_N_E=e.O()}]);