(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[154],{2956:(e,t,a)=>{"use strict";a.d(t,{u:()=>l});var r=a(3464),i=a(9018);let l=r.A.create({baseURL:"http://localhost:3000/api"});l.interceptors.request.use(e=>{let t=i.n.getState().token;return t&&(e.headers.Authorization="Bearer ".concat(t)),e},e=>Promise.reject(e)),l.interceptors.response.use(e=>e,e=>(e.response&&401===e.response.status&&!window.location.pathname.endsWith("/login")&&(console.warn("API client: 401 Unauthorized, logging out."),i.n.getState().logout()),Promise.reject(e)))},3892:e=>{e.exports={tableWrapper:"CreditPackageTable_tableWrapper__mRuyi",tableHeader:"CreditPackageTable_tableHeader__LzKzQ",dataRow:"CreditPackageTable_dataRow__gnVyO",descriptionCell:"CreditPackageTable_descriptionCell__Z7t9E"}},5282:(e,t,a)=>{Promise.resolve().then(a.bind(a,9087))},7651:(e,t,a)=>{"use strict";a.d(t,{d:()=>i});var r=a(2956);let i={getCreditPackages:async()=>(await r.u.get("/credit-packages")).data,getCreditPackageById:async e=>(await r.u.get("/credit-packages/".concat(e))).data,createCreditPackage:async e=>(await r.u.post("/credit-packages",e)).data,updateCreditPackage:async(e,t)=>(await r.u.patch("/credit-packages/".concat(e),t)).data,async deleteCreditPackage(e){await r.u.delete("/credit-packages/".concat(e))}}},9018:(e,t,a)=>{"use strict";a.d(t,{n:()=>l});var r=a(5453),i=a(6786);let l=(0,r.v)()((0,i.Zr)((e,t)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null,theme:"light",setUser:(t,a)=>{console.log("AuthStore: Setting user and token",{user:t,token:a}),e({user:t,token:a,isAuthenticated:!!t&&!!a,isLoading:!1,error:null})},logout:()=>{console.log("AuthStore: Logging out"),e({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null})},setCountryOfOrigin:t=>{e(e=>({user:e.user?{...e.user,countryOfOrigin:t}:null}))},setLoading:t=>e({isLoading:t}),setError:t=>e({isLoading:!1,error:t}),hydrateAuth:(t,a)=>{t&&a?(console.log("AuthStore: Hydrating auth state",{initialUser:t,initialToken:a}),e({user:t,token:a,isAuthenticated:!0,isLoading:!1,error:null})):e({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null})},setTheme:t=>{console.log("AuthStore: Setting theme to",t),e({theme:t})},toggleTheme:()=>{let a,r=t().theme;console.log("AuthStore: Toggling theme to",a="light"===r?"dark":"dark"===r||window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"light":"dark"),e({theme:a})}}),{name:"pwa-auth-storage",storage:(0,i.KU)(()=>localStorage),partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated,theme:e.theme}),onRehydrateStorage:()=>e=>{console.log("AuthStore: State rehydrated from localStorage. Theme:",null==e?void 0:e.theme),e&&(e.isLoading=!1)}}))},9087:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>L});var r=a(5155),i=a(8104),l=a(112),s=a(3751),n=a(6707),c=a(4634),d=a(6467),o=(0,d.A)("outline","packages","IconPackages",[["path",{d:"M7 16.5l-5 -3l5 -3l5 3v5.5l-5 3z",key:"svg-0"}],["path",{d:"M2 13.5v5.5l5 3",key:"svg-1"}],["path",{d:"M7 16.545l5 -3.03",key:"svg-2"}],["path",{d:"M17 16.5l-5 -3l5 -3l5 3v5.5l-5 3z",key:"svg-3"}],["path",{d:"M12 19l5 3",key:"svg-4"}],["path",{d:"M17 16.5l5 -3",key:"svg-5"}],["path",{d:"M12 13.5v-5.5l-5 -3l5 -3l5 3v5.5",key:"svg-6"}],["path",{d:"M7 5.03v5.455",key:"svg-7"}],["path",{d:"M12 8l5 -3",key:"svg-8"}]]),h=a(1698),g=a(8977),u=a(7017),p=a(6715),x=a(2960),m=a(5041),k=a(5695),j=a(6942),y=a(7651),v=a(1183),A=a(6029),w=a(1005),C=a(3191),b=a(8141),T=a(3347),P=a(8887),E=(0,d.A)("outline","circle-check","IconCircleCheck",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M9 12l2 2l4 -4",key:"svg-1"}]]),S=(0,d.A)("outline","circle-x","IconCircleX",[["path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0",key:"svg-0"}],["path",{d:"M10 10l4 4m0 -4l-4 4",key:"svg-1"}]]),X=a(1503),f=a(6701),_=a(3892),M=a.n(_);function q(e){let{packages:t,isLoading:a,onEdit:s,onDelete:n}=e,c=t.map(e=>{var t;return(0,r.jsxs)(v.X.Tr,{className:M().dataRow,children:[(0,r.jsx)(v.X.Td,{children:e.name}),(0,r.jsx)(v.X.Td,{className:M().descriptionCell,children:e.description||"-"}),(0,r.jsx)(v.X.Td,{style:{textAlign:"center"},children:e.credit_amount}),(0,r.jsx)(v.X.Td,{style:{textAlign:"right"},children:null==(t=e.price)?void 0:t.toLocaleString("es-PE",{style:"currency",currency:"PEN"})}),(0,r.jsx)(v.X.Td,{style:{textAlign:"center"},children:(0,r.jsx)(A.E,{color:e.isActive?"green":"red",variant:"light",leftSection:e.isActive?(0,r.jsx)(E,{size:14}):(0,r.jsx)(S,{size:14}),children:e.isActive?"Activo":"Inactivo"})}),(0,r.jsx)(v.X.Td,{style:{textAlign:"center"},children:(0,r.jsxs)(l.Y,{gap:"xs",justify:"center",wrap:"nowrap",children:[(0,r.jsx)(w.m,{label:"Editar Paquete",children:(0,r.jsx)(C.M,{variant:"subtle",color:"blue",onClick:()=>s(e),children:(0,r.jsx)(X.A,{size:18})})}),(0,r.jsx)(w.m,{label:"Eliminar Paquete",children:(0,r.jsx)(C.M,{variant:"subtle",color:"red",onClick:()=>n(e),children:(0,r.jsx)(f.A,{size:18})})})]})})]},e.id)});return(0,r.jsx)(i.a,{className:M().tableWrapper,children:(0,r.jsxs)(v.X,{striped:!0,highlightOnHover:!0,withColumnBorders:!0,verticalSpacing:"sm",miw:700,children:[(0,r.jsx)(v.X.Thead,{className:M().tableHeader,children:(0,r.jsxs)(v.X.Tr,{children:[(0,r.jsx)(v.X.Th,{children:"Nombre del Paquete"}),(0,r.jsx)(v.X.Th,{children:"Descripci\xf3n"}),(0,r.jsx)(v.X.Th,{style:{textAlign:"center",width:"100px"},children:"Cr\xe9ditos"}),(0,r.jsx)(v.X.Th,{style:{textAlign:"right",width:"120px"},children:"Precio (PEN)"}),(0,r.jsx)(v.X.Th,{style:{textAlign:"center",width:"120px"},children:"Estado"}),(0,r.jsx)(v.X.Th,{style:{textAlign:"center",width:"100px"},children:"Acciones"})]})}),(0,r.jsxs)(v.X.Tbody,{children:[a&&(0,r.jsx)(v.X.Tr,{children:(0,r.jsx)(v.X.Td,{colSpan:6,children:(0,r.jsx)(b.o,{p:"xl",children:(0,r.jsx)(T.a,{color:"blue"})})})}),!a&&0===t.length&&(0,r.jsx)(v.X.Tr,{children:(0,r.jsx)(v.X.Td,{colSpan:6,children:(0,r.jsx)(b.o,{p:"xl",children:(0,r.jsx)(P.E,{c:"dimmed",children:"No hay paquetes de cr\xe9dito definidos."})})})}),!a&&t.length>0&&c]})]})})}let z=new u.E({});function L(){return(0,r.jsx)(p.Ht,{client:z,children:(0,r.jsx)(N,{})})}function N(){let e=(0,k.useRouter)(),t=(0,p.jE)(),{data:a,isError:d,isLoading:u,refetch:v}=(0,x.I)({queryKey:["credit-packages"],queryFn:y.d.getCreditPackages}),A=Array.isArray(a)?a:(null==a?void 0:a.data)||[];Array.isArray(a)?a.length:null==a||a.total;let{mutateAsync:w}=(0,m.n)({mutationFn:y.d.deleteCreditPackage,onSuccess:(e,a)=>{j.$e.show({title:"Paquete Eliminado",message:"El paquete de cr\xe9dito ha sido eliminado.",color:"green"}),t.invalidateQueries({queryKey:["credit-packages"]})},onError:e=>{j.$e.show({title:"Error al Eliminar",message:e.message||"No se pudo eliminar el paquete.",color:"red"})}}),C=async e=>{window.confirm('\xbfEst\xe1 seguro de que desea eliminar el paquete "'.concat(e.name,'"?'))&&await w(e.id||"")};return(0,r.jsxs)(i.a,{p:"lg",children:[(0,r.jsxs)(l.Y,{justify:"space-between",mb:"xl",children:[(0,r.jsxs)(s.h,{order:2,children:[(0,r.jsx)(o,{size:28,style:{marginRight:"10px",verticalAlign:"bottom"}}),"Gesti\xf3n de Paquetes de Cr\xe9dito"]}),(0,r.jsxs)(l.Y,{children:[(0,r.jsx)(n.$,{onClick:()=>e.push("/admin/credit-packages/create"),leftSection:(0,r.jsx)(o,{size:18}),variant:"filled",color:"blue",children:"Nuevo Paquete"}),(0,r.jsx)(n.$,{onClick:()=>v(),leftSection:(0,r.jsx)(h.A,{size:18}),variant:"default",loading:u&&A.length>0,disabled:u&&A.length>0,children:"Refrescar"})]})]}),d&&!u&&(0,r.jsx)(c.F,{icon:(0,r.jsx)(g.A,{size:"1rem"}),title:"Error de Carga",color:"red",withCloseButton:!0,mb:"md",children:"No se pudieron cargar los paquetes de cr\xe9dito."}),(0,r.jsx)(q,{packages:A,isLoading:u,onEdit:t=>{e.push("/admin/credit-packages/edit/".concat(t.id))},onDelete:C})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[339,545,438,660,877,700,219,749,811,258,441,684,358],()=>t(5282)),_N_E=e.O()}]);